define("text!common/tpl/top.tpl",[],function(){return'<!--edit 和detail 共用-->\n<%if(route!=\'newmeet\'){%>\n<div class="crumbs">\n        <span class="back">返回</span><span><%=htitle%></span>&gt;<span><%=data.title%></span>\n</div>\n<%}%>\n\n<div class="wrapnew">\n<!--详情页-->\n<%if(!route.match(/detail/)){%>\n    <div class="wnew">\n        <div class="wtitle">\n            <span  class="ltab">会议主题</span>\n            <div class="scenter"><input autocomplete="off" value="<%=data.title%>"  type="text" name="title" data-check="need" data-tips="self"/></div>\n            <div class="wrappro">产品线：<div class="sright2"><input id="product"\n               name="productline" value="<%=data.productline%>" type="text" data-role="product"     /></div></div>\n        </div>\n        <div class="wtime">\n            <span class="ltab">会议时间</span><p class="start">\n            <input autocomplete="off"  type="text" id="datemonth" data-time="<%if(date.stime){%><%=date.stime[0]%><%}%>"/><input class="date" autocomplete="off"  type="text" id="datetimer"  data-time="<%if(date.stime){%><%=date.stime[1]%><%}%>"/></p>\n            ~<p class="end">\n            <input autocomplete="off"  type="text" id="datemonth1" data-time="<%if(date.etime){%><%=date.etime[0]%><%}%>"/><input class="date" autocomplete="off"  type="text" id="datetimer1"  data-time="<%if(date.etime){%><%=date.etime[1]%><%}%>"/></p>\n        </div>\n        <div class="wadress">\n            <span class="ltab">会议地点</span>\n            <div class="sright"><input name="address" value="<%=data.address%>"  autocomplete="off"  id="adress1" type="text"  data-role="address"  data-tips="self"  /></div>\n        </div>\n        <div class="wperson">\n            <span class="ltab">负责人</span>\n            <div class="sright"><%if(data.owner){%><span class="val" data-id="<%=data.owner.username%>"><%=data.owner.name%></span><%}%><input autocomplete="off"  id="person1"  type="text"  data-role="person" data-tips="parent" data-check="only need"/></div>\n        </div>\n        <div class="wattend">\n            <span class="ltab">参会人</span>\n            <div class="sright"><%if(data.attends&&data.attends.length){for(var i=0,l=data.attends.length;i<l;i++){ var d=data.attends[i]%><span class="val" data-id="<%=d.username%>"><%=d.name%></span><%}}%><input autocomplete="off"  id="person2" data-data="filter=all" type="text" data-role="person" data-tips="parent"  data-check="need"/></div>\n        </div>\n        <div class="wmark">\n            <span class="ltab">备注</span>\n            <div class="sright"><input name="desc" autocomplete="off"  type="text"  value="<%=data.desc%>"/></div>\n        </div>\n        <div class="wmore">\n            <span class="ltab">更多</span><input autocomplete="off"  class="bluebox" type="checkbox" name="is_todo" id="remind" <%if(data.is_todo==\'1\'){%>checked<%}%>/>生成Hi待办 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input autocomplete="off"\n                class="bluebox" type="checkbox" name="is_email" id="email" <%if(data.is_mail==\'1\'){%>checked<%}%> />发送会议邮件\n        </div>\n        <%if(route!=\'detailp\'&&route!=\'detailm\'){%>\n        <div class="op3">\n            <%if(route==\'editmeet\'){%>\n            <div class="save">保存</div>\n            <%}else{%>\n            <div class="send">提交会议</div>\n            <%}%>\n\n            <div class="cancel">取消</div>\n        </div>\n        <%}%>\n\n    </div>\n<!--编辑页-->\n<%}else{%>\n    <div class="meetdetails">\n        <div class="op3">\n            <!--<span class="add" data-url="<%=data.docurl%>"><a href="#" target="_blank" title="">添加会议纪要</a></span>--><%if(data.is_allowedit){%><span class="edit"><a href="#" title="">编辑</a></span><%}%><%if(data.is_allowdel){%><span class="del"><a href="#" title="">删除</a></span><%}%><span\n                class="copy"><a href="#" title="">复制</a></span>\n        </div>\n        <div class="title"><span class="tit"><%=data.title%></span><span class="name"><%=data.productline%></span>\n        </div>\n\n        <div class="wnew">\n            <div><span  class="ltab">会议时间</span><div><%=data.meeting_stime%>&nbsp;&nbsp;~&nbsp;&nbsp;<%=data.meeting_etime%></div></div>\n            <div><span  class="ltab">会议地点</span><div class="l80"><%=data.address%></div></div>\n            <div><span class="ltab">负责人</span><div class="l80"><%if(data.owner){%><%=data.owner.name%><%}%></div></div>\n            <div><span class="ltab">参会人</span><div class="l80"><%if(data.attends){%><%for(var i=0,l=data.attends.length;i<l;i++){%><%=data.attends[i].name%><%if(i!==l-1){%>、<%}%><%}%><%}%></div></div>\n            <div><span class="ltab">备注</span><div class="l80"><%=data.desc%></div></div>\n        </div>\n    </div>\n    <%}%>\n\n</div>\n'}),define("text!views/detail/detail.css",[],function(){return""}),define("views/detail/detail",["text!common/tpl/top.tpl","text!views/detail/detail.css","common/js/jquery.datetimepicker"],function(e,t){var n=Backbone.BaseView.extend({el:"#detail",cssText:t,template:_.template(e),tpl403:_.template('<div class="inner">如有问题请联系会议负责人：<span><%=data.name%></span><%if(data.hi){%><span>Hi: <a href="baidu://message/?id=<%=data.hi%>"><%=data.hi%></a></span><%}%><span>E-mail: <a href="mailto:<%=data.email%>"><%=data.email%></a></span></div>'),events:$.extend({"click .op3>span":"clickop3"},Backbone.BaseView.baseEvents),modal:{},init:function(){var e=this;window.onbeforeunload=function(){e.isSave&&window.opener.onCloseNewMeet(e.options.mid)},this.date=$.fn.getCurDate()},destory:function(){this.$el.html("").hide()},display:function(e){var t=this;this.options=e,this.$el.show(),this.insertData()},insertData:function(e){var t=this,n=this.options,r={};n.mid&&(r.mid=n.mid);if(n.route=="editmeet"&&n.copy==1||n.route=="newmeet")r.act="incr";$.ajax({cache:!1,url:$.urlMap.meetDetail,data:r,type:"GET",dataType:"json",success:function(e){if(e.errno){switch(e.errno){case 20009:case 30008:$.ajax({url:$.urlMap.meetInfo,dataType:"json",type:"GET",cache:!1,data:{sid:t.options.mid},success:function(e){if(e.errno)return;e=e.result;var n=$('<div class="m404"></div>').html(t.tpl403({data:e}));t.$el.html(n)}});break;case 20001:case 30002:t.$el.html($('<div class="m403"></div>'))}return}e=e.result,n.mid=e.mid,t.date.stime=e.meeting_stime.split(" "),t.date.etime=e.meeting_etime.split(" "),n.data=e;switch(n.route){case"detailm":n.htitle=$.allConfig.mapMeeting[n.role];break;case"detailp":n.htitle=t.options.role;break;case"meeting":n.htitle=$.allConfig.mapMeeting[n.role];break;case"editmeet":n.htitle=n.copy==1?"会议复制":"编辑会议"}t.$el.html(t.template(n)),Backbone.Events.trigger("insertDoclist",n)}})},clickop3:function(e){var t=$(e.currentTarget);e.preventDefault();var n=t.attr("class");n.match(/edit/)?this.goEdit(e):n.match(/del/)?this.delMeet(e,this.options.mid):n.match(/copy/)&&this.goCopyMeet(e)},delMeet:function(e,t){var n=this,r;e.stopPropagation(),t||(r=$(e.currentTarget).parents("tr"),t=r.attr("data-mid")),this.openConfirm1(t,function(){$.fn.tips("删除成功！",1),window.updateItem=!0,n.goMainPage()});return},goEdit:function(){var e=this.options;this.goEditPage(e)},goCopyMeet:function(e){var t=this.options;t.copy=1,this.goEditPage(t)}});return n});